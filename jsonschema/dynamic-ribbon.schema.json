{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "JSON Schema for Office Add-in Dynamic Ribbon",
  "description": "A file describing the data format for an Office Add-in's Dynamic Ribbon definition used in the requestUpdate() API.",
  "type": "object",
  "properties": {
    "actions": {
      "description": "Ribbon actions.",
      "type": "array",
      "items": {
        "anyOf": [
          {
            "$ref": "#/definitions/showTaskpaneAction"
          },
          {
            "$ref": "#/definitions/executeFunctionAction"
          }
        ]
      }
    },
    "tabs": {
      "description": "Ribbon tab definitions.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/tabElement"
      },
      "minLength": 1,
      "maxLength": 10
    },
    "version": {
      "description": "The version of the ribbon JSON schema.",
      "type": "string"
    }
  },
  "required": [
    "actions",
    "tabs",
    "version"
  ],
  "definitions": {
    "showTaskpaneAction": {
      "title": "ShowTaskpane Action",
      "description": "An action that will display content in a task pane.",
      "type": "object",
      "properties": {
        "id": {
          "title": "Action ID",
          "description": "The unique ID of the action.",
          "type": "string"
        },
        "type": {
          "title": "Action type",
          "description": "The type of the action.",
          "const": "ShowTaskpane"
        },
        "sourceLocation": {
          "title": "Source Location",
          "description": "The source file location for the start page of the task pane. For shared runtime, this can be omitted.",
          "type": "string",
          "format": "uri"
        },
        "taskpaneId": {
          "title": "Taskpane ID",
          "description": "The ID of the task pane container.",
          "type": "string"
        },
        "title": {
          "title": "Title",
          "description": "The custom title for the task pane.",
          "type": "string",
          "minLength": 1,
          "maxLength": 125
        },
        "supportPinning": {
          "title": "Support Pinning",
          "description": "Specifies that a task pane supports pinning, which keeps the task pane open when the user changes the selection.",
          "type": "boolean"
        }
      },
      "required": [
        "id",
        "type"
      ],
      "dependencies": {
        "sourceLocation": [
          "title"
        ]
      }
    },
    "executeFunctionAction": {
      "title": "ExecuteFunction Action",
      "description": "An action that runs a JavaScript function loaded by the file referenced by FunctionFile.",
      "type": "object",
      "properties": {
        "id": {
          "title": "Action ID",
          "description": "The unique ID of the action.",
          "type": "string"
        },
        "type": {
          "title": "Action type",
          "description": "The type of the action.",
          "const": "ExecuteFunction"
        },
        "functionName": {
          "title": "Function Name",
          "description": "The name of the function to execute defined in the function file.",
          "type": "string"
        },
        "functionFile": {
          "title": "Function File",
          "description": "The file that loads JavaScript code to run when an add-in command uses the ExecuteFunction action. The function will be executed as shared-runtime if this field is not provided.",
          "type": "string",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "type",
        "functionName"
      ]
    },
    "superTip": {
      "title": "SuperTip",
      "description": "The supertip for this button, which is defined by title and description.",
      "type": "object",
      "properties": {
        "title": {
          "title": "Title",
          "description": "The text for the supertip.",
          "type": "string",
          "minLength": 1,
          "maxLength": 125
        },
        "description": {
          "title": "Description",
          "description": "The description for the supertip. Note: (Outlook) Only Windows and Mac clients are supported.",
          "type": "string",
          "minLength": 1,
          "maxLength": 250
        }
      },
      "required": [
        "title",
        "description"
      ]
    },
    "icon": {
      "title": "Icon",
      "description": "The images for elements.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "size": {
            "title": "Size",
            "description": "The size in pixels of the image.",
            "type": "integer",
            "enum": [
              16,
              20,
              24,
              32,
              40,
              48,
              64,
              80
            ]
          },
          "sourceLocation": {
            "title": "Source Location",
            "description": "The URL of the icon.",
            "type": "string",
            "format": "uri"
          }
        },
        "required": [
          "size",
          "sourceLocation"
        ]
      }
    },
    "element": {
      "$comment": "The root type for any control in Office ribbon.",
      "type": "object",
      "properties": {
        "id": {
          "title": "Element ID",
          "description": "The unique ID of the control element. Can be a maximum of 125 characters.",
          "type": "string"
        },
        "label": {
          "title": "Label",
          "description": "The text for the element.",
          "type": "string",
          "maxLength": 125
        }
      },
      "required": [
        "id",
        "label"
      ]
    },
    "tabElement": {
      "title": "Ribbon Tab Element",
      "allOf": [
        {
          "$ref": "#/definitions/element"
        },
        {
          "properties": {
            "visible": {
              "description": "The visibility of this tab.",
              "type": "boolean",
              "default": true
            },
            "groups": {
              "description": "The groups under this tab.",
              "type": "array",
              "items": {
                "$ref": "#/definitions/groupElement"
              },
              "maxLength": 6
            }
          },
          "required": [
            "groups"
          ]
        }
      ]
    },
    "iconElement": {
      "$comment": "An abstract type represents any control within a ribbon tab (i.e. Group, Button), which owns an icon.",
      "allOf": [
        {
          "$ref": "#/definitions/element"
        },
        {
          "properties": {
            "icon": {
              "$ref": "#/definitions/icon"
            }
          },
          "required": [
            "icon"
          ]
        }
      ]
    },
    "groupElement": {
      "title": "Group element",
      "description": "Defines a group of UI controls in a tab. Each group is limited to 6 controls.",
      "allOf": [
        {
          "$ref": "#/definitions/iconElement"
        },
        {
          "properties": {
            "controls": {
              "type": "array",
              "items": {
                "anyOf": [
                  {
                    "$ref": "#/definitions/menuElement"
                  },
                  {
                    "$ref": "#/definitions/buttonElement"
                  }
                ]
              }
            }
          },
          "required": [
            "controls"
          ]
        }
      ]
    },
    "buttonLikeElement": {
      "$comment": "An abstract type represents the control under a Group (i.e. Menu, Button).",
      "allOf": [
        {
          "$ref": "#/definitions/iconElement"
        },
        {
          "properties": {
            "toolTip": {
              "title": "ToolTip",
              "description": "The tooltip for the element.",
              "type": "string",
              "maxLength": 250
            },
            "superTip": {
              "$ref": "#/definitions/superTip"
            }
          },
          "required": [
            "superTip"
          ]
        }
      ]
    },
    "actionableElement": {
      "$comment": "An abstract type represents controls which can trigger an action.",
      "allOf": [
        {
          "$ref": "#/definitions/buttonLikeElement"
        },
        {
          "properties": {
            "enabled": {
              "title": "Title",
              "description": "Specifies whether the control is enabled when the ribbon is generated.",
              "type": "boolean",
              "default": true
            },
            "actionId": {
              "title": "Action ID",
              "description": "The action to perform.",
              "type": "string"
            }
          },
          "required": [
            "actionId"
          ]
        }
      ]
    },
    "buttonElement": {
      "title": "Button Element",
      "description": "A button performs a single action when the user selects it.",
      "allOf": [
        {
          "$ref": "#/definitions/actionableElement"
        },
        {
          "properties": {
            "type": {
              "title": "Type",
              "description": "Type of the element.",
              "const": "Button"
            }
          },
          "required": [
            "type"
          ]
        }
      ]
    },
    "menuItemElement": {
      "title": "Menu Item Element",
      "description": "A menu item element in a menu.",
      "allOf": [
        {
          "$ref": "#/definitions/actionableElement"
        },
        {
          "properties": {
            "type": {
              "title": "Type",
              "description": "Type of the element.",
              "const": "MenuItem"
            }
          },
          "required": [
            "type"
          ]
        }
      ]
    },
    "menuElement": {
      "title": "Menu Element",
      "description": "A menu element in the ribbon, may contain multiple menu items. Submenus are not supported.",
      "allOf": [
        {
          "$ref": "#/definitions/buttonLikeElement"
        },
        {
          "properties": {
            "type": {
              "title": "Type",
              "description": "Type of the element",
              "const": "Menu"
            },
            "items": {
              "description": "A collection of one or more menu items.",
              "type": "array",
              "items": {
                "$ref": "#/definitions/menuItemElement"
              }
            }
          },
          "required": [
            "type",
            "items"
          ]
        }
      ]
    }
  }
}